<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å»£æ±æ­Œå¡«è©å¤§è³½ - é¦–é </title>
    <link rel="stylesheet" href="style.css">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.3.4/html5-qrcode.min.js" integrity="sha512-k/KAe4Yff9EUdYI5/IAHlwUswqeipP+Cp5qnrsUjTPCgl51La2/JhyyjNciztD7mWNKLSXci48m7cctATKfLlQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <style>
        /* Specific styles for the scanner to look good on mobile */
        #reader {
            width: 100%;
            border-radius: 8px;
            overflow: hidden;
            background: #000;
        }
        /* Hide the annoying 'Scan an Image File' link if you only want camera */
        #reader__dashboard_section_csr span {
            display: none !important;
        }
    </style>
</head>
<body>

    <header class="navbar">
        <a href="index.html">ğŸ  å¡«è©å¤§å¸« Board Game</a>
    </header>

    <main class="container">
        
        <section class="card">
            <h3>ğŸ”¤ è¼¸å…¥é¡Œç›®</h3>
            <div class="input-group">
                <input type="text" placeholder="è¼¸å…¥ç·¨è™Ÿ (ä¾‹å¦‚: 001)" id="questionInput">
                <button class="btn btn-primary" onclick="goToQuestionManual()">ç¢ºèªå‰å¾€</button>
            </div>
        </section>

        <section class="card">
            <h3>ğŸ“· æƒç„ QR Code</h3>
            <p style="margin-bottom: 10px; font-size: 0.9rem; color: #666;">è«‹å…è¨±ä½¿ç”¨ç›¸æ©Ÿæ¬Šé™</p>
            
            <div id="reader"></div>
            
            <div id="scanResult" class="text-center" style="margin-top: 10px; font-weight: bold; color: green;"></div>
        </section>

        <section class="card">
            <h2>ğŸ“œ éŠæˆ²è¦å‰‡</h2>
            <ul style="padding-left: 20px;">
                <li>æŠ½å–ä¸€å¼µ<strong>æ—‹å¾‹å¡</strong>ã€‚</li>
                <li>æƒç„å¡ä¸Šçš„ QR Codeã€‚</li>
                <li>è†è½æ—‹å¾‹ï¼Œä¸¦æ ¹æ“š<strong>é¡Œç›®å¡</strong>çš„ä¸»é¡Œå¡«å¯«æ­Œè©ã€‚</li>
            </ul>
        </section>

    </main>

    <script>
        // --- 1. Manual Input Logic ---
        function goToQuestionManual() {
            const input = document.getElementById('questionInput').value;
            if(input) {
                // Redirect to question page
                window.location.href = 'question.html?id=' + input;
            } else {
                alert("è«‹è¼¸å…¥ç·¨è™Ÿï¼");
            }
        }

        // --- 2. QR Code Scanner Logic (from your article) ---
        
        // This function runs when a code is successfully scanned
        function onScanSuccess(decodedText, decodedResult) {
            // Handle the result
            console.log(`Scan result: ${decodedText}`, decodedResult);
            
            // Visual feedback
            document.getElementById('scanResult').innerText = "æƒç„æˆåŠŸï¼æ­£åœ¨è·³è½‰...";

            // Stop the scanner to save battery/resources
            html5QrcodeScanner.clear();

            // Check if the scanned text is a URL or just an ID
            if (decodedText.includes("question.html")) {
                // If it's a full URL (e.g., https://site.com/question.html?id=001)
                window.location.href = decodedText; 
            } else {
                // If the QR code ONLY contains the number (e.g., "001")
                // We assume it's an ID and redirect manually
                window.location.href = 'question.html?id=' + decodedText;
            }
        }

        function onScanError(errorMessage) {
            // handle on error condition, with error message
            // We usually ignore this because it triggers on every frame it DOESN'T see a code
            // console.warn(`Code scan error = ${errorMessage}`);
        }

        // Initialize the Scanner
        // 'reader' matches the id of our div
        const html5QrcodeScanner = new Html5QrcodeScanner(
            "reader", 
            { 
                fps: 10,       // Frames per second (lower = less battery usage)
                qrbox: { width: 250, height: 250 } // Size of the scanning box
            },
            /* verbose= */ false
        );
        
        html5QrcodeScanner.render(onScanSuccess, onScanError);

    </script>
</body>
</html>